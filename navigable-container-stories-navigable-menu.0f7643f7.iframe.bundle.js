"use strict";(self.webpackChunkgutenberg=self.webpackChunkgutenberg||[]).push([[6521],{"./packages/components/src/navigable-container/container.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _wordpress_element__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_wordpress_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/dom/build-module/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");const noop=()=>{},MENU_ITEM_ROLES=["menuitem","menuitemradio","menuitemcheckbox"];class NavigableContainer extends _wordpress_element__WEBPACK_IMPORTED_MODULE_1__.Component{constructor(){super(...arguments),this.onKeyDown=this.onKeyDown.bind(this),this.bindContainer=this.bindContainer.bind(this),this.getFocusableContext=this.getFocusableContext.bind(this),this.getFocusableIndex=this.getFocusableIndex.bind(this)}componentDidMount(){this.container.addEventListener("keydown",this.onKeyDown),this.container.addEventListener("focus",this.onFocus)}componentWillUnmount(){this.container.removeEventListener("keydown",this.onKeyDown),this.container.removeEventListener("focus",this.onFocus)}bindContainer(ref){const{forwardedRef:forwardedRef}=this.props;this.container=ref,"function"==typeof forwardedRef?forwardedRef(ref):forwardedRef&&"current"in forwardedRef&&(forwardedRef.current=ref)}getFocusableContext(target){const{onlyBrowserTabstops:onlyBrowserTabstops}=this.props,focusables=(onlyBrowserTabstops?_wordpress_dom__WEBPACK_IMPORTED_MODULE_2__.T_.tabbable:_wordpress_dom__WEBPACK_IMPORTED_MODULE_2__.T_.focusable).find(this.container),index=this.getFocusableIndex(focusables,target);return index>-1&&target?{index:index,target:target,focusables:focusables}:null}getFocusableIndex(focusables,target){const directIndex=focusables.indexOf(target);if(-1!==directIndex)return directIndex}onKeyDown(event){this.props.onKeyDown&&this.props.onKeyDown(event);const{getFocusableContext:getFocusableContext}=this,{cycle:cycle=!0,eventToOffset:eventToOffset,onNavigate:onNavigate=noop,stopNavigationEvents:stopNavigationEvents}=this.props,offset=eventToOffset(event);if(void 0!==offset&&stopNavigationEvents){event.stopImmediatePropagation();const targetRole=event.target.getAttribute("role"),targetHasMenuItemRole=MENU_ITEM_ROLES.includes(targetRole),isTab="Tab"===event.code;(targetHasMenuItemRole||isTab)&&event.preventDefault()}if(!offset)return;const context=getFocusableContext(event.target.ownerDocument.activeElement);if(!context)return;const{index:index,focusables:focusables}=context,nextIndex=cycle?function cycleValue(value,total,offset){const nextValue=value+offset;return nextValue<0?total+nextValue:nextValue>=total?nextValue-total:nextValue}(index,focusables.length,offset):index+offset;nextIndex>=0&&nextIndex<focusables.length&&(focusables[nextIndex].focus(),onNavigate(nextIndex,focusables[nextIndex]))}render(){const{children:children,stopNavigationEvents:stopNavigationEvents,eventToOffset:eventToOffset,onNavigate:onNavigate,onKeyDown:onKeyDown,cycle:cycle,onlyBrowserTabstops:onlyBrowserTabstops,forwardedRef:forwardedRef,...restProps}=this.props;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{ref:this.bindContainer,...restProps,children:children})}}NavigableContainer.displayName="NavigableContainer";const forwardedNavigableContainer=(props,ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(NavigableContainer,{...props,forwardedRef:ref});forwardedNavigableContainer.displayName="forwardedNavigableContainer",forwardedNavigableContainer.displayName="NavigableContainer",forwardedNavigableContainer.__docgenInfo={description:"",methods:[],displayName:"NavigableContainer"},__webpack_exports__.Z=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_1__.forwardRef)(forwardedNavigableContainer),"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/components/src/navigable-container/container.js"]={name:"forwardedNavigableContainer",docgenInfo:forwardedNavigableContainer.__docgenInfo,path:"packages/components/src/navigable-container/container.js"})},"./packages/components/src/navigable-container/menu.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _wordpress_element__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),_container__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/components/src/navigable-container/container.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");function NavigableMenu(_ref,ref){let{role:role="menu",orientation:orientation="vertical",...rest}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_container__WEBPACK_IMPORTED_MODULE_1__.Z,{ref:ref,stopNavigationEvents:!0,onlyBrowserTabstops:!1,role:role,"aria-orientation":"presentation"===role?null:orientation,eventToOffset:evt=>{const{code:code}=evt;let next=["ArrowDown"],previous=["ArrowUp"];return"horizontal"===orientation&&(next=["ArrowRight"],previous=["ArrowLeft"]),"both"===orientation&&(next=["ArrowRight","ArrowDown"],previous=["ArrowLeft","ArrowUp"]),next.includes(code)?1:previous.includes(code)?-1:["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(code)?0:void 0},...rest})}NavigableMenu.displayName="NavigableMenu",NavigableMenu.__docgenInfo={description:"",methods:[],displayName:"NavigableMenu",props:{role:{defaultValue:{value:"'menu'",computed:!1},required:!1},orientation:{defaultValue:{value:"'vertical'",computed:!1},required:!1}}},__webpack_exports__.Z=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_2__.forwardRef)(NavigableMenu),"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/components/src/navigable-container/menu.js"]={name:"NavigableMenu",docgenInfo:NavigableMenu.__docgenInfo,path:"packages/components/src/navigable-container/menu.js"})},"./packages/dom/build-module/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{T_:function(){return build_module_focus}});var focusable_namespaceObject={};__webpack_require__.r(focusable_namespaceObject),__webpack_require__.d(focusable_namespaceObject,{find:function(){return find}});var tabbable_namespaceObject={};function buildSelector(sequential){return[sequential?'[tabindex]:not([tabindex^="-"])':"[tabindex]","a[href]","button:not([disabled])",'input:not([type="hidden"]):not([disabled])',"select:not([disabled])","textarea:not([disabled])",'iframe:not([tabindex^="-"])',"object","embed","area[href]","[contenteditable]:not([contenteditable=false])"].join(",")}function isVisible(element){return element.offsetWidth>0||element.offsetHeight>0||element.getClientRects().length>0}function isValidFocusableArea(element){const map=element.closest("map[name]");if(!map)return!1;const img=element.ownerDocument.querySelector('img[usemap="#'+map.name+'"]');return!!img&&isVisible(img)}function find(context){let{sequential:sequential=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const elements=context.querySelectorAll(buildSelector(sequential));return Array.from(elements).filter((element=>{if(!isVisible(element))return!1;const{nodeName:nodeName}=element;return"AREA"!==nodeName||isValidFocusableArea(element)}))}function getTabIndex(element){const tabIndex=element.getAttribute("tabindex");return null===tabIndex?0:parseInt(tabIndex,10)}function isTabbableIndex(element){return-1!==getTabIndex(element)}function mapElementToObjectTabbable(element,index){return{element:element,index:index}}function mapObjectTabbableToElement(object){return object.element}function compareObjectTabbables(a,b){const aTabIndex=getTabIndex(a.element),bTabIndex=getTabIndex(b.element);return aTabIndex===bTabIndex?a.index-b.index:aTabIndex-bTabIndex}function filterTabbable(focusables){return focusables.filter(isTabbableIndex).map(mapElementToObjectTabbable).sort(compareObjectTabbables).map(mapObjectTabbableToElement).reduce(function createStatefulCollapseRadioGroup(){const CHOSEN_RADIO_BY_NAME={};return function collapseRadioGroup(result,element){const{nodeName:nodeName,type:type,checked:checked,name:name}=element;if("INPUT"!==nodeName||"radio"!==type||!name)return result.concat(element);const hasChosen=CHOSEN_RADIO_BY_NAME.hasOwnProperty(name);if(!checked&&hasChosen)return result;if(hasChosen){const hadChosenElement=CHOSEN_RADIO_BY_NAME[name];result=result.filter((e=>e!==hadChosenElement))}return CHOSEN_RADIO_BY_NAME[name]=element,result.concat(element)}}(),[])}function tabbable_find(context){return filterTabbable(find(context))}function findPrevious(element){return filterTabbable(find(element.ownerDocument.body)).reverse().find((focusable=>element.compareDocumentPosition(focusable)&element.DOCUMENT_POSITION_PRECEDING))}function findNext(element){return filterTabbable(find(element.ownerDocument.body)).find((focusable=>element.compareDocumentPosition(focusable)&element.DOCUMENT_POSITION_FOLLOWING))}__webpack_require__.r(tabbable_namespaceObject),__webpack_require__.d(tabbable_namespaceObject,{find:function(){return tabbable_find},findNext:function(){return findNext},findPrevious:function(){return findPrevious},isTabbableIndex:function(){return isTabbableIndex}});const build_module_focus={focusable:focusable_namespaceObject,tabbable:tabbable_namespaceObject}},"./packages/components/src/navigable-container/stories/navigable-menu.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:function(){return Default}});var ___WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/components/src/navigable-container/menu.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");__webpack_exports__.default={parameters:{sourceLink:"packages/components/src/navigable-container",storySource:{source:"/**\n * Internal dependencies\n */\nimport { NavigableMenu } from '..';\n\nexport default {\n\ttitle: 'Components/NavigableMenu',\n\tcomponent: NavigableMenu,\n\targTypes: {\n\t\tchildren: { type: null },\n\t\tcycle: {\n\t\t\ttype: 'boolean',\n\t\t},\n\t\tonNavigate: { action: 'onNavigate' },\n\t\torientation: {\n\t\t\toptions: [ 'horizontal', 'vertical' ],\n\t\t\tcontrol: { type: 'radio' },\n\t\t},\n\t},\n};\n\nexport const Default = ( args ) => {\n\treturn (\n\t\t<>\n\t\t\t<button>Before navigable menu</button>\n\t\t\t<NavigableMenu\n\t\t\t\t{ ...args }\n\t\t\t\tstyle={ {\n\t\t\t\t\tmargin: '32px 0',\n\t\t\t\t\tpadding: '16px',\n\t\t\t\t\tborder: '1px solid black',\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t<div role=\"menuitem\">Item 1 (non-tabbable, non-focusable)</div>\n\t\t\t\t<button role=\"menuitem\">Item 2 (tabbable, focusable)</button>\n\t\t\t\t<button role=\"menuitem\" disabled>\n\t\t\t\t\tItem 3 (disabled, therefore non-tabbable and not-focusable)\n\t\t\t\t</button>\n\t\t\t\t<span role=\"menuitem\" tabIndex={ -1 }>\n\t\t\t\t\tItem 4 (non-tabbable, non-focusable)\n\t\t\t\t</span>\n\t\t\t\t<div role=\"menuitem\" tabIndex={ 0 }>\n\t\t\t\t\tItem 5 (tabbable, focusable)\n\t\t\t\t</div>\n\t\t\t</NavigableMenu>\n\t\t\t<button>After navigable menu</button>\n\t\t</>\n\t);\n};\n",locationsMap:{default:{startLoc:{col:23,line:22},endLoc:{col:1,line:49},startBody:{col:23,line:22},endBody:{col:1,line:49}}}}},title:"Components/NavigableMenu",component:___WEBPACK_IMPORTED_MODULE_1__.Z,argTypes:{children:{type:null},cycle:{type:"boolean"},onNavigate:{action:"onNavigate"},orientation:{options:["horizontal","vertical"],control:{type:"radio"}}}};const Default=args=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{children:"Before navigable menu"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(___WEBPACK_IMPORTED_MODULE_1__.Z,{...args,style:{margin:"32px 0",padding:"16px",border:"1px solid black"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{role:"menuitem",children:"Item 1 (non-tabbable, non-focusable)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{role:"menuitem",children:"Item 2 (tabbable, focusable)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{role:"menuitem",disabled:!0,children:"Item 3 (disabled, therefore non-tabbable and not-focusable)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{role:"menuitem",tabIndex:-1,children:"Item 4 (non-tabbable, non-focusable)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{role:"menuitem",tabIndex:0,children:"Item 5 (tabbable, focusable)"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{children:"After navigable menu"})]});Default.__docgenInfo={description:"",methods:[],displayName:"Default"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/components/src/navigable-container/stories/navigable-menu.js"]={name:"Default",docgenInfo:Default.__docgenInfo,path:"packages/components/src/navigable-container/stories/navigable-menu.js"})}}]);